{% extends 'layout.html' %}

{% block content %}
<!-- Formulario para filtrar libros -->
    <!-- Formulario para filtrar libros -->
    <!-- Formulario para filtrar libros -->
    <div class="filter-container">
        <form action="{{ url_for('libros.verlibro') }}" method="GET">
            <!-- Filtro por Título -->
            <div class="filter-group">
                <input type="text" id="titulo" name="titulo" placeholder="Buscar título..." value="{{ request.args.get('titulo', '') }}">
            </div>
    
            <!-- Filtro por Autor -->
            <div class="filter-group">
                <select id="autor" name="autor">
                    <option value="">Todos los autores</option>
                    {% for autor in autores %}
                        <option value="{{ autor.nombre }}" {% if request.args.get('autor') == autor.nombre %}selected{% endif %}>
                            {{ autor.nombre }} {{ autor.apellido }}
                        </option>
                    {% endfor %}
                </select>
            </div>
    
            <!-- Filtro por Editorial -->
            <div class="filter-group">
                <select id="editorial" name="editorial">
                    <option value="">Todas las editoriales</option>
                    {% for editorial in editoriales %}
                        <option value="{{ editorial.nombre }}" {% if request.args.get('editorial') == editorial.nombre %}selected{% endif %}>
                            {{ editorial.nombre }}
                        </option>
                    {% endfor %}
                </select>
            </div>
    
            <!-- Filtro por Género -->
            <div class="filter-group">
                <select id="genero" name="genero">
                    <option value="">Todos los géneros</option>
                    {% for genero in generos %}
                        <option value="{{ genero.nombre }}" {% if request.args.get('genero') == genero.nombre %}selected{% endif %}>
                            {{ genero.nombre }}
                        </option>
                    {% endfor %}
                </select>
            </div>
    
            <button type="submit" class="filter-button">Filtrar</button>
        </form>
    </div>
</form>
  
</head>
<body>
    <main id="main" class="flexbox-col">
        <h1>Lista de Libros</h1>
        
        <div class="container">
            <header>
                <h1>Lista de Libros</h1>
                <a href="{{url_for('libros.index')}}" class="btn agregar-btn">Agregar Libro</a>
            </header>
            <section class="book-list">
                {% for libro in pagination %}
                <div class="book-card">
                    <div class="book-details">
                        <div class="book-image">
                            <img src="{{ url_for('static', filename='img/' ~ libro.img) }}" alt="{{ libro.titulo }}" style="width:150px;height:200px;">

                        </div>
                        <div class="book-info">
                            <h2>{{ libro.titulo }}</h2>
                            <p>Autor: {{ libro.autor.nombre }} {{ libro.autor.apellido }}</p>
                            <p>Género: {{ libro.genero.nombre }}</p>
                            <p>Precio: ${{ libro.precio }}</p>
                            <p><a href="{{ url_for('libros.detalle', libro_id=libro.id) }}">Ver Detalles</a></p>
                        </div>
                    </div>
                    <div class="book-actions">
                        <a href="{{ url_for('libros.editarlibro', id=libro.id) }}" class="btn edit-btn">Editar</a>
                        <a href="{{ url_for('libros.eliminarlibro', id=libro.id) }}" class="btn delete-btn">Eliminar</a>
                    </div>
                </div>
                {% endfor %}
            </section>
                <ul class="pagination">
                    {% if pagination.has_prev %}
                    <li><a href="{{ url_for('libros.verlibro', page=pagination.prev_num) }}">Anterior</a></li>
                    {% endif %}
                    
                    {% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
                        {% if page_num %}
                            {% if page_num == pagination.page %}
                                <li class="active"><strong>{{ page_num }}</strong></li>
                            {% else %}
                                <li><a href="{{ url_for('libros.verlibro', page=page_num) }}">{{ page_num }}</a></li>
                            {% endif %}
                        {% else %}
                            <li class="li">…</li>
                        {% endif %}
                    {% endfor %}
        
                    {% if pagination.has_next %}
                    <li><a href="{{ url_for('libros.verlibro', page=pagination.next_num) }}">Siguiente</a></li>
                    {% endif %}
                </ul>
                
                <!-- Paginación aquí -->
            

            </main>
            {% endblock %}
</body>
</html>
